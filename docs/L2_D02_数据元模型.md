---
id: L2_D02_META_V0.3
title: 数据元模型（L2）
level: L2
domain: D02
version: V0.3
status: enhanced
---

**本节要点**：（1）数据域基础抽象：Entity、Relation、Index、Migration、Query；（2）与 L3_D02、formal-model/data-model 的对应；（3）完整性、一致性约束与治理。  
**预计阅读时间**：全文约 30–40 分钟；仅读概述 + 元模型元素约 15 分钟。

## 1. 概述

- 范围：实体、关系、索引、查询、迁移、安全、性能、治理
- 目标：定义数据系统的基础抽象、约束、验证规则和治理机制
- 原则：完整性、一致性、可追溯性、性能优化、安全性、合规性

### 1.1 前置与关联

- **对应理论**：[formal-model/data-model/theory.md](formal-model/data-model/theory.md)
- **本层细化**：本 L2 元模型为数据域的基础抽象；具体标准与 DSL 见 L3。
- **下游标准**：[L3_D02 数据标准模型](L3_D02_数据标准模型.md)；对象/属性/不变式映射详情见 [L2↔L3 映射总表 2.2 节（数据）](formal-model/alignment-L2-L3-matrix.md#22-数据d02)。
- **与权威对标**：本 L2 与标准/课程知识点对照见 [AUTHORITY_STANDARD_COURSE_L2L3_MATRIX](reference/AUTHORITY_STANDARD_COURSE_L2L3_MATRIX.md)、[AUTHORITY_ALIGNMENT_INDEX](reference/AUTHORITY_ALIGNMENT_INDEX.md) 第 2–3 节。

## 2. 元模型元素

### 2.1 核心实体

#### Entity（实体）

- **属性**：
  - `id`: 唯一标识符
  - `name`: 实体名称
  - `type`: 实体类型（business/technical/system）
  - `version`: 版本号
  - `status`: 状态（active/deprecated/archived）
  - `lifecycle`: 生命周期阶段
  - `audit`: 审计信息（创建时间、修改时间、创建者、修改者）
  - `security`: 安全配置（访问控制、加密、脱敏）
  - `performance`: 性能配置（分区、压缩、缓存）
  - `governance`: 治理配置（数据质量、合规性、血缘关系）
  - `metadata`: 元数据（描述、标签、分类、业务规则）
- **约束**：名称唯一性、类型有效性、版本连续性、安全配置完整性

#### Field（字段）

- **属性**：
  - `name`: 字段名称
  - `type`: 数据类型（primitive/complex/reference）
  - `size`: 字段大小
  - `nullable`: 是否可为空
  - `default`: 默认值
  - `validation`: 验证规则
  - `metadata`: 元数据（描述、单位、格式等）
  - `security`: 安全属性（敏感级别、加密要求、脱敏规则）
  - `performance`: 性能属性（索引建议、分区键、压缩策略）
  - `business`: 业务属性（业务规则、计算逻辑、派生规则）
  - `quality`: 质量属性（数据质量规则、清洗规则、标准化规则）
- **约束**：名称唯一性、类型有效性、大小合理性、安全配置完整性

#### Relation（关系）

- **属性**：
  - `name`: 关系名称
  - `type`: 关系类型（one-to-one/one-to-many/many-to-many）
  - `source`: 源实体
  - `target`: 目标实体
  - `cardinality`: 基数约束
  - `cascade`: 级联操作（none/delete/update）
  - `optional`: 是否可选
  - `integrity`: 完整性约束（引用完整性、业务完整性）
  - `performance`: 性能优化（连接策略、索引建议）
  - `audit`: 审计追踪（关系变更历史、影响分析）
  - `governance`: 治理规则（血缘关系、影响分析、变更管理）
- **约束**：关系完整性、循环检测、基数一致性、完整性约束有效性

#### Index（索引）

- **属性**：
  - `name`: 索引名称
  - `type`: 索引类型（primary/unique/normal/fulltext/spatial）
  - `fields`: 索引字段列表
  - `order`: 排序方式（asc/desc）
  - `unique`: 是否唯一
  - `partial`: 部分索引条件
  - `performance`: 性能配置（填充因子、并行度、维护策略）
  - `storage`: 存储配置（表空间、压缩、分区）
  - `monitoring`: 监控配置（使用统计、性能指标、维护建议）
- **约束**：名称唯一性、字段有效性、类型一致性、性能配置合理性

#### Constraint（约束）

- **属性**：
  - `name`: 约束名称
  - `type`: 约束类型（primary_key/foreign_key/unique/check/not_null）
  - `expression`: 约束表达式
  - `enforcement`: 执行级别（immediate/deferred）
  - `deferrable`: 是否可延迟
  - `validation`: 验证规则（自定义验证函数、业务规则）
  - `performance`: 性能影响（约束检查开销、优化建议）
  - `monitoring`: 监控配置（违反统计、告警规则）
- **约束**：表达式有效性、执行级别合理性、验证规则可行性

#### Query（查询）

- **属性**：
  - `name`: 查询名称
  - `type`: 查询类型（select/insert/update/delete/ddl/dml）
  - `sql`: SQL语句
  - `parameters`: 参数定义
  - `performance`: 性能配置（执行计划、优化提示、并行度）
  - `security`: 安全配置（权限检查、行级安全、列级安全）
  - `monitoring`: 监控配置（执行统计、性能指标、告警规则）
  - `caching`: 缓存配置（查询结果缓存、执行计划缓存）
- **约束**：SQL语法正确性、参数完整性、性能配置合理性

#### Migration（迁移）

- **属性**：
  - `name`: 迁移名称
  - `type`: 迁移类型（schema/data/version/rollback）
  - `version`: 版本号
  - `dependencies`: 依赖关系
  - `up`: 升级脚本
  - `down`: 回滚脚本
  - `validation`: 验证规则（数据完整性、业务规则）
  - `rollback`: 回滚策略（自动回滚、手动回滚、部分回滚）
  - `monitoring`: 监控配置（执行状态、性能指标、错误处理）
- **约束**：版本连续性、依赖完整性、脚本有效性、回滚可行性

#### Security（安全）

- **属性**：
  - `authentication`: 认证机制（用户认证、角色认证、证书认证）
  - `authorization`: 授权策略（访问控制、权限管理、角色管理）
  - `encryption`: 加密配置（字段加密、传输加密、存储加密）
  - `masking`: 脱敏规则（静态脱敏、动态脱敏、条件脱敏）
  - `audit`: 审计配置（操作日志、访问日志、变更日志）
  - `compliance`: 合规要求（数据保护、隐私保护、行业标准）
- **约束**：认证有效性、授权完整性、加密强度、合规性要求

#### Performance（性能）

- **属性**：
  - `partitioning`: 分区策略（范围分区、哈希分区、列表分区）
  - `compression`: 压缩策略（行压缩、列压缩、混合压缩）
  - `caching`: 缓存策略（查询缓存、结果缓存、统计缓存）
  - `parallelism`: 并行配置（并行度、并行策略、负载均衡）
  - `optimization`: 优化配置（查询优化、索引优化、统计优化）
- **约束**：分区策略合理性、压缩配置有效性、缓存策略合理性

#### Governance（治理）

- **属性**：
  - `quality`: 数据质量（准确性、完整性、一致性、及时性）
  - `lineage`: 血缘关系（数据来源、数据流向、数据转换）
  - `catalog`: 数据目录（元数据管理、数据发现、数据搜索）
  - `lifecycle`: 生命周期（数据创建、数据使用、数据归档、数据删除）
  - `compliance`: 合规管理（法规遵从、标准遵从、政策遵从）
- **约束**：质量规则有效性、血缘关系完整性、目录信息准确性

### 2.2 与 L3 对齐增强点

- 实体/字段：对齐 L3 数据标准，细化 `unique_constraints/check_constraints/triggers/views` 的映射；字段层引入 `json/uuid` 类型与 `format/range/length` 约束。
- 关系：补充 `self_referencing/junction_table/relationship_types`，对齐一对一/一对多/多对多的基数与级联策略。
- 迁移：引入 `has_inverse/idempotent/atomic/isolated/durable` 属性，匹配迁移可逆与安全性约束。
- 一致性模型：纳入 `strong/eventual/causal` 标签，用于存储系统一致性语义标注与验证策略选择。

## 3. 形式化不变式补充

```text
// 主键唯一
Invariant L2D1 (PrimaryKeyUniqueness):
  primary_key(entity, key) ⇒ unique(entity, key)

// 外键完整
Invariant L2D2 (ForeignKeyIntegrity):
  ∀ rel(a→b), row_a. ∃ row_b ∈ b. fk(row_a, row_b)

// 迁移可逆（与 L3 对齐）
Invariant L2D3 (MigrationReversibility):
  has_inverse(m) ∧ apply(m); apply(inverse(m)) = identity

// 模式一致性
Invariant L2D4 (SchemaConformance):
  ∀ record. record.conforms_to(entity.schema)

// 一致性标签约束
Invariant L2D5 (ConsistencyLabelSoundness):
  label(data_store) ∈ {strong, eventual, causal}
```

以上不变式可选用 TLA+/Alloy/Why3 等形式化规格语言表达，参见 [形式化规格语言与工具族](reference/FORMAL_SPEC_LANGUAGES.md)。

## 4. 与 L3/L4 映射

- L3：`L3_D02_数据标准模型.md` 的 EntityDesign/FieldDefinition/RelationshipModeling 与迁移规范
- L4：金融（账户/交易/合规）、电商（订单/库存/营销）、物联网（设备/传感器/时序）

### 2.3 关系定义

#### 结构关系（Structural）

- **包含关系**：Entity包含Field
- **关联关系**：Entity通过Relation关联
- **继承关系**：Entity继承自其他Entity
- **组合关系**：Entity组合其他Entity
- **聚合关系**：Entity聚合其他Entity

#### 依赖关系（Dependency）

- **强依赖**：删除源实体必须删除目标实体
- **弱依赖**：删除源实体不影响目标实体
- **可选依赖**：源实体可以独立存在
- **循环依赖**：实体间的循环引用关系
- **传递依赖**：通过中间实体的间接依赖

#### 版本关系（Versioning）

- **版本链**：Entity的版本演进关系
- **分支关系**：Entity的并行版本分支
- **合并关系**：分支版本的合并操作
- **快照关系**：特定时间点的数据快照
- **增量关系**：版本间的增量变更

#### 安全关系（Security）

- **权限关系**：用户/角色与实体的权限关系
- **加密关系**：加密算法与字段的加密关系
- **脱敏关系**：脱敏规则与字段的脱敏关系
- **审计关系**：审计策略与实体的审计关系
- **合规关系**：合规要求与实体的合规关系

#### 性能关系（Performance）

- **索引关系**：索引与字段的优化关系
- **分区关系**：分区策略与实体的分区关系
- **缓存关系**：缓存策略与查询的缓存关系
- **并行关系**：并行策略与操作的并行关系
- **优化关系**：优化策略与性能的优化关系

#### 治理关系（Governance）

- **血缘关系**：数据来源与数据流向的血缘关系
- **影响关系**：变更对下游系统的影响关系
- **质量关系**：质量规则与数据质量的关系
- **生命周期关系**：数据在不同阶段的生命周期关系
- **合规关系**：合规要求与数据合规的关系

## 5. 约束与不变式

### 5.1 结构约束

#### 唯一性约束

- Entity的name在相同类型下必须唯一
- Field的name在相同Entity下必须唯一
- Index的name在相同Entity下必须唯一
- Constraint的name在相同Entity下必须唯一
- Query的name在相同系统中必须唯一
- Migration的version在相同系统中必须唯一

#### 完整性约束

- Entity必须包含至少一个Field
- Field必须定义完整的type和validation
- Relation必须定义完整的source和target
- Index必须关联有效的Field
- Constraint必须定义有效的expression
- Query必须包含有效的SQL语句

#### 一致性约束

- 版本号必须遵循语义化版本规范
- 数据类型必须符合类型系统定义
- 约束表达式必须语法正确
- SQL语句必须符合数据库方言
- 迁移脚本必须可执行

### 5.2 行为约束

#### 生命周期约束

- 删除的Entity必须清理相关Field和Relation
- 废弃的Field不能有新的引用
- 过期的Index必须被重建或删除
- 失效的Constraint必须被修复或移除
- 失败的Migration必须能够回滚

#### 安全约束

- 敏感数据必须加密存储
- 访问权限必须明确控制
- 审计日志必须完整记录
- 脱敏规则必须严格执行
- 合规要求必须满足

#### 性能约束

- 查询响应时间不能超过SLA定义
- 索引维护开销必须在可接受范围内
- 分区策略必须平衡负载
- 缓存策略必须提高性能
- 并行度必须合理配置

### 5.3 业务约束

#### 数据质量约束

- 数据准确性必须满足业务要求
- 数据完整性必须保证业务逻辑
- 数据一致性必须维护业务规则
- 数据及时性必须满足业务时效
- 数据可用性必须保证业务连续性

#### 合规约束

- 必须符合数据保护法规
- 必须满足行业标准要求
- 必须通过合规审计
- 必须建立数据治理机制
- 必须维护数据主权

#### 治理约束

- 变更必须经过审批流程
- 影响分析必须完整准确
- 血缘关系必须及时更新
- 质量监控必须持续进行
- 合规检查必须定期执行

## 4. 验证规则

### 4.1 结构验证

#### 语法验证

- SQL语法检查
- 约束表达式语法检查
- 数据类型语法检查
- 索引定义语法检查
- 迁移脚本语法检查

#### 语义验证

- 业务规则验证
- 数据一致性验证
- 关系完整性验证
- 约束有效性验证
- 依赖关系验证

### 4.2 行为验证

#### 功能验证

- 数据操作功能测试
- 约束执行功能测试
- 索引使用功能测试
- 查询执行功能测试
- 迁移执行功能测试

#### 性能验证

- 查询性能测试
- 索引性能测试
- 约束性能测试
- 迁移性能测试
- 并发性能测试

#### 安全验证

- 认证功能测试
- 授权功能测试
- 加密功能测试
- 脱敏功能测试
- 审计功能测试

### 4.3 集成验证

#### 兼容性验证

- 版本兼容性测试
- 向后兼容性测试
- 向前兼容性测试
- 跨平台兼容性测试
- 跨数据库兼容性测试

#### 互操作性验证

- 数据格式互操作性测试
- 接口互操作性测试
- 协议互操作性测试
- 工具互操作性测试
- 系统互操作性测试

## 5. 元模型扩展点

### 5.1 可扩展属性

- 自定义元数据
- 业务特定属性
- 技术特定属性
- 环境特定属性
- 行业特定属性

### 5.2 可扩展约束

- 自定义验证规则
- 业务特定约束
- 技术特定约束
- 合规特定约束
- 性能特定约束

### 5.3 可扩展验证

- 自定义验证器
- 业务特定验证
- 技术特定验证
- 合规特定验证
- 性能特定验证

## 6. 工具支持

### 6.1 建模工具

- 可视化建模器
- 代码生成器
- 文档生成器
- 验证工具
- 反向工程工具

### 6.2 开发工具

- IDE插件
- 调试工具
- 测试工具
- 部署工具
- 版本管理工具

### 6.3 运维工具

- 监控工具
- 日志工具
- 告警工具
- 分析工具
- 优化工具

### 6.4 治理工具

- 数据目录工具
- 血缘分析工具
- 质量监控工具
- 合规检查工具
- 影响分析工具

## 7. 最佳实践

### 7.1 设计原则

- 单一职责原则
- 开闭原则
- 里氏替换原则
- 接口隔离原则
- 依赖倒置原则
- 数据归一化原则
- 性能优先原则

### 7.2 命名规范

- 使用清晰的描述性名称
- 遵循一致的命名约定
- 避免缩写和歧义
- 使用领域术语
- 遵循数据库命名规范

### 7.3 文档规范

- 提供完整的数据字典
- 包含业务规则说明
- 说明约束和限制
- 提供使用示例
- 维护变更历史

## 8. 演进策略

### 8.1 版本管理

- 遵循语义化版本规范
- 维护向后兼容性
- 提供迁移指南
- 支持渐进式升级
- 建立版本策略

### 8.2 变更管理

- 变更影响评估
- 变更审批流程
- 变更通知机制
- 变更回滚策略
- 变更追踪机制

### 8.3 质量保证

- 自动化测试
- 代码审查
- 性能监控
- 安全审计
- 合规检查
- 数据质量监控
- 血缘关系维护

## 11. 权威对标

- **标准与证据**：本模型与 ISO/IEC 25012 数据质量模型、L3_D02 数据标准模型对应。参见 [权威对标总索引](reference/AUTHORITY_ALIGNMENT_INDEX.md) 第 2 节、[evidence/STD-15288](evidence/STD-15288.md)。
- **课程映射**：数据建模对应 LEARNING_PATHS 初学者阶段1「数据模型」；课程见 AUTHORITY_ALIGNMENT_INDEX 第 3 节（如 CMU 15-445、Stanford CS 245）。

参见：[L2↔L3 映射总表](formal-model/alignment-L2-L3-matrix.md)
