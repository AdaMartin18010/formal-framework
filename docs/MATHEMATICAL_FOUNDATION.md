# Formal Framework 数学基础体系

## 1. 概述

Formal Framework 建立严格的数学基础体系，为形式化建模、验证和推理提供理论支撑。本体系基于现代数学和计算机科学理论，确保所有形式化方法的严谨性和可靠性。

## 2. 数理逻辑基础

### 2.1 命题逻辑

#### 2.1.1 基本概念

**定义 2.1.1** 命题（Proposition）
命题是一个具有确定真值的陈述句，用符号 P, Q, R 等表示。

**定义 2.1.2** 逻辑连接词

- 否定（¬）：¬P 表示"非P"
- 合取（∧）：P ∧ Q 表示"P且Q"
- 析取（∨）：P ∨ Q 表示"P或Q"
- 蕴含（→）：P → Q 表示"如果P则Q"
- 等价（↔）：P ↔ Q 表示"P当且仅当Q"

#### 2.1.2 真值表

| P | Q | ¬P | P ∧ Q | P ∨ Q | P → Q | P ↔ Q |
|---|---|----|-------|-------|-------|-------|
| T | T | F  |   T   |   T   |   T   |   T   |
| T | F | F  |   F   |   T   |   F   |   F   |
| F | T | T  |   F   |   T   |   T   |   F   |
| F | F | T  |   F   |   F   |   T   |   T   |

#### 2.1.3 推理规则

**公理 2.1.1** 假言推理（Modus Ponens）

```text
P → Q
P
-----
Q
```

**公理 2.1.2** 否定推理（Modus Tollens）

```text
P → Q
¬Q
-----
¬P
```

**公理 2.1.3** 合取引入

```text
P
Q
-----
P ∧ Q
```

### 2.2 一阶逻辑

#### 2.2.1 基本概念

**定义 2.2.1** 量词

- 全称量词（∀）：∀x P(x) 表示"对所有x，P(x)成立"
- 存在量词（∃）：∃x P(x) 表示"存在x，使得P(x)成立"

**定义 2.2.2** 谓词
谓词是描述对象性质的函数，如 P(x) 表示"x具有性质P"。

**定义 2.2.3** 函数符号
函数符号表示对象间的映射关系，如 f(x) 表示"x的函数值"。

#### 2.2.2 形式化语义

**定义 2.2.4** 解释（Interpretation）
解释 I = (D, I) 包含：

- D：论域（Domain）
- I：解释函数，将常量、函数符号、谓词符号映射到论域

**定义 2.2.5** 满足关系（⊨）
给定解释 I 和赋值 σ，满足关系定义如下：

- I, σ ⊨ P(t₁, ..., tₙ) 当且仅当 (I(t₁), ..., I(tₙ)) ∈ I(P)
- I, σ ⊨ ∀x φ 当且仅当对所有 d ∈ D，I, σ[x↦d] ⊨ φ
- I, σ ⊨ ∃x φ 当且仅当存在 d ∈ D，使得 I, σ[x↦d] ⊨ φ

### 2.3 模态逻辑

#### 2.3.1 时态逻辑

**定义 2.3.1** 时态算子

- □（必然）：□φ 表示"φ总是成立"
- ◇（可能）：◇φ 表示"φ有时成立"
- ○（下一个）：○φ 表示"下一个时刻φ成立"
- U（直到）：φ U ψ 表示"φ成立直到ψ成立"

#### 2.3.2 线性时态逻辑（LTL）

**公理 2.3.1** LTL公理

```text
□(φ → ψ) → (□φ → □ψ)  // 分配律
□φ → φ                  // 反射性
□φ → □□φ               // 传递性
```

## 3. 集合论基础

### 3.1 基本概念

**定义 3.1.1** 集合
集合是不同对象的无序聚集，用大写字母 A, B, C 等表示。

**定义 3.1.2** 元素关系
x ∈ A 表示"x是集合A的元素"。

**定义 3.1.3** 子集关系
A ⊆ B 表示"A是B的子集"，即 ∀x (x ∈ A → x ∈ B)。

### 3.2 集合运算

**定义 3.2.1** 并集
A ∪ B = {x | x ∈ A ∨ x ∈ B}

**定义 3.2.2** 交集
A ∩ B = {x | x ∈ A ∧ x ∈ B}

**定义 3.2.3** 差集
A - B = {x | x ∈ A ∧ x ∉ B}

**定义 3.2.4** 补集
A' = {x | x ∉ A}

### 3.3 关系理论

**定义 3.3.1** 二元关系
R ⊆ A × B 是集合A到集合B的二元关系。

**定义 3.3.2** 等价关系
关系R是等价关系，当且仅当：

- 自反性：∀x (x, x) ∈ R
- 对称性：∀x,y ((x, y) ∈ R → (y, x) ∈ R)
- 传递性：∀x,y,z (((x, y) ∈ R ∧ (y, z) ∈ R) → (x, z) ∈ R)

**定义 3.3.3** 偏序关系
关系R是偏序关系，当且仅当：

- 自反性：∀x (x, x) ∈ R
- 反对称性：∀x,y (((x, y) ∈ R ∧ (y, x) ∈ R) → x = y)
- 传递性：∀x,y,z (((x, y) ∈ R ∧ (y, z) ∈ R) → (x, z) ∈ R)

## 4. 类型论基础

### 4.1 基本类型

**定义 4.1.1** 基本类型

- Bool：布尔类型，值域 {true, false}
- Nat：自然数类型，值域 {0, 1, 2, ...}
- Int：整数类型，值域 {..., -2, -1, 0, 1, 2, ...}
- Real：实数类型
- String：字符串类型

### 4.2 复合类型

**定义 4.2.1** 积类型
A × B 表示类型A和B的笛卡尔积，元素为 (a, b)。

**定义 4.2.2** 和类型
A + B 表示类型A和B的不相交并集，元素为 inl(a) 或 inr(b)。

**定义 4.2.3** 函数类型
A → B 表示从类型A到类型B的函数。

**定义 4.2.4** 列表类型
List[A] 表示类型A的有限序列。

### 4.3 类型系统

**定义 4.3.1** 类型推导规则

```text
变量规则：
Γ, x:A ⊢ x:A

抽象规则：
Γ, x:A ⊢ e:B
------------
Γ ⊢ λx:A.e:A→B

应用规则：
Γ ⊢ e₁:A→B    Γ ⊢ e₂:A
------------------------
Γ ⊢ e₁ e₂:B

对规则：
Γ ⊢ e₁:A    Γ ⊢ e₂:B
---------------------
Γ ⊢ (e₁, e₂):A×B
```

**定义 4.3.2** 类型安全
如果表达式e有类型A，则e的求值不会产生类型错误。

## 5. 证明论基础

### 5.1 自然演绎系统

**定义 5.1.1** 自然演绎规则

```text
引入规则：
φ    ψ
-----
φ ∧ ψ

消除规则：
φ ∧ ψ
-----
φ

φ ∧ ψ
-----
ψ
```

### 5.2 公理化系统

**定义 5.2.1** 命题逻辑公理

```text
A1: φ → (ψ → φ)
A2: (φ → (ψ → χ)) → ((φ → ψ) → (φ → χ))
A3: (¬φ → ¬ψ) → (ψ → φ)
```

**定义 5.2.2** 推理规则

```text
分离规则：
φ → ψ    φ
---------
ψ
```

### 5.3 一致性证明

**定理 5.3.1** 一致性
如果 ⊢ φ 且 ⊢ ¬φ，则系统不一致。

**证明**：
假设系统不一致，即存在φ使得 ⊢ φ 且 ⊢ ¬φ。
根据爆炸原理，对任意ψ，有 ⊢ ψ。
这与系统的预期行为矛盾，因此系统必须一致。

### 5.4 完备性证明

**定理 5.4.1** 完备性
如果 ⊨ φ，则 ⊢ φ。

**证明思路**：

1. 构造反证法
2. 假设 ⊨ φ 但 ⊬ φ
3. 构造极大一致集
4. 构造模型使得 ¬φ 为真
5. 与 ⊨ φ 矛盾

## 6. 形式化方法应用

### 6.1 程序验证

**定义 6.1.1** Hoare三元组
{P} C {Q} 表示：如果在执行程序C之前断言P为真，且C终止，则执行后断言Q为真。

**公理 6.1.1** 赋值公理
{P[E/x]} x := E {P}

**公理 6.1.2** 序列公理

```text
{P} C₁ {R}    {R} C₂ {Q}
------------------------

{P} C₁; C₂ {Q}
```

**公理 6.1.3** 条件公理

```text
{P ∧ B} C₁ {Q}    {P ∧ ¬B} C₂ {Q}
--------------------------------

{P} if B then C₁ else C₂ {Q}
```

### 6.2 模型检查

**定义 6.2.1** Kripke结构
M = (S, S₀, R, L) 其中：

- S：状态集合
- S₀ ⊆ S：初始状态集合
- R ⊆ S × S：转换关系
- L：标签函数，L(s) ⊆ AP

**定义 6.2.2** 模型检查问题
给定Kripke结构M和LTL公式φ，判断是否 M ⊨ φ。

### 6.3 抽象解释

**定义 6.3.1** 抽象域
抽象域是一个格 (A, ⊑, ⊥, ⊤, ⊔, ⊓)，其中：

- ⊑：偏序关系
- ⊥：最小元素
- ⊤：最大元素
- ⊔：最小上界
- ⊓：最大下界

**定义 6.3.2** Galois连接
(α, γ) 是具体域C和抽象域A之间的Galois连接，当且仅当：

- α: C → A 是抽象函数
- γ: A → C 是具体化函数
- ∀c ∈ C, a ∈ A: α(c) ⊑ a ⇔ c ⊑ γ(a)

## 7. 总结

本数学基础体系为Formal Framework提供了：

1. **严格的逻辑基础**：命题逻辑、一阶逻辑、模态逻辑
2. **完整的集合论**：集合运算、关系理论
3. **现代类型论**：类型系统、类型安全
4. **证明论方法**：自然演绎、公理化系统
5. **形式化应用**：程序验证、模型检查、抽象解释

这些理论基础确保了Formal Framework中所有形式化方法的严谨性和可靠性，为后续的DSL设计、形式化验证和自动化推理提供了坚实的数学支撑。

## 参考文献

1. Enderton, H. B. (2001). A Mathematical Introduction to Logic. Academic Press.
2. Mendelson, E. (2015). Introduction to Mathematical Logic. CRC Press.
3. Pierce, B. C. (2002). Types and Programming Languages. MIT Press.
4. Clarke, E. M., Grumberg, O., & Peled, D. A. (1999). Model Checking. MIT Press.
5. Cousot, P., & Cousot, R. (1977). Abstract interpretation: a unified lattice model for static analysis of programs by construction or approximation of fixpoints. In Proceedings of the 4th ACM SIGACT-SIGPLAN symposium on Principles of programming languages (pp. 238-252).
